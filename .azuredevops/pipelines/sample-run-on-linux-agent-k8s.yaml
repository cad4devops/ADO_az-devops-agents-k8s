trigger: none

parameters:
  - name: linuxPoolName
    type: string
    default: "KubernetesLinuxPool001"
    displayName: "Linux Pool Name"

# resources:
#   repositories:
#     - repository: templates
#       displayname: templates from devops
#       type: git
#       name: Cad4DevOps/ADO_az-devops-agents-k8s
#       ref: main

stages:
  - stage: DeployInParallel
    displayName: "Deploy in Parallel"
    pool:
      name: ${{ parameters.linuxPoolName }}
      # demands:
      #   - Agent.OS -equals Linux
      #   - Agent.Name -equals $(Agent.Name)
      #   - Agent.Version -equals $(Agent.Version)
    jobs:
      - job: parallelTest1
        displayName: "Parallel Test 1"
        steps:
          #Branch Checkout
          - checkout: self
            persistCredentials: true

          # Hello World program
          - template: ../scripts/kubernetes/linux/hello-world.yaml #@templates

          # test docker
          - task: CmdLine@2
            displayName: test docker
            inputs:
              script: |
                echo Write your commands here

                echo Hello world

                docker -v
      - job: parallelTest2
        displayName: "Parallel Test 2"
        steps:
          #Branch Checkout
          - checkout: self
            persistCredentials: true

          # Hello World program
          - template: ../scripts/kubernetes/linux/hello-world.yaml #@templates

          # test docker
          - task: CmdLine@2
            displayName: test docker
            inputs:
              script: |
                echo Write your commands here

                echo Hello world

                docker -v
      - job: parallelTest3
        displayName: "Parallel Test 3"
        steps:
          #Branch Checkout
          - checkout: self
            persistCredentials: true

          # Hello World program
          - template: ../scripts/kubernetes/linux/hello-world.yaml #@templates

          # test docker
          - task: CmdLine@2
            displayName: test docker
            inputs:
              script: |
                echo Write your commands here

                echo Hello world

                docker -v
      - job: parallelTest4
        displayName: "Parallel Test 4"
        steps:
          #Branch Checkout
          - checkout: self
            persistCredentials: true

          # Hello World program
          - template: ../scripts/kubernetes/linux/hello-world.yaml #@templates

          # test docker
          - task: CmdLine@2
            displayName: test docker
            inputs:
              script: |
                echo Write your commands here

                echo Hello world

                docker -v
      - job: parallelTest5
        displayName: "Parallel Test 5"
        steps:
          #Branch Checkout
          - checkout: self
            persistCredentials: true

          # Hello World program
          - template: ../scripts/kubernetes/linux/hello-world.yaml #@templates

          # test docker
          - task: CmdLine@2
            displayName: test docker
            inputs:
              script: |
                echo Write your commands here

                echo Hello world

                docker -v
